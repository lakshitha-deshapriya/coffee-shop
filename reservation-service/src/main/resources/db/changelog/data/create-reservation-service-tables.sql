CREATE TABLE RESERVATION (
            RESERVATION_ID      SERIAL NOT NULL PRIMARY KEY,
            CUSTOMER_ID         INT4 NOT NULL,
            TAX                 NUMERIC(8,2) NOT NULL,
            TOTAL_AMOUNT        NUMERIC(8,2) NOT NULL,
            SHOP_ID             INT4 NOT NULL,
            ORDER_TIME          TIMESTAMP,
            STATUS              INT4 NOT NULL);

COMMENT ON TABLE RESERVATION IS 'Order done by customer';
COMMENT ON COLUMN RESERVATION.RESERVATION_ID IS 'Reservation Id';
COMMENT ON COLUMN RESERVATION.CUSTOMER_ID IS 'Reserved customer';
COMMENT ON COLUMN RESERVATION.TAX IS 'Tax amount';
COMMENT ON COLUMN RESERVATION.TOTAL_AMOUNT IS 'Total amount';
COMMENT ON COLUMN RESERVATION.SHOP_ID IS 'Reserved shop Id';
COMMENT ON COLUMN RESERVATION.ORDER_TIME IS 'Ordered time';
COMMENT ON COLUMN RESERVATION.STATUS IS 'Order status';

ALTER TABLE RESERVATION ADD CONSTRAINT FK_RESERVATION_USER FOREIGN KEY (CUSTOMER_ID) REFERENCES APP_USER (USER_ID);
ALTER TABLE RESERVATION ADD CONSTRAINT FK_RESERVATION_SHOP FOREIGN KEY (SHOP_ID) REFERENCES SHOP (SHOP_ID);

CREATE TABLE RESERVATION_ITEM (
            RES_ITEM_ID         SERIAL NOT NULL PRIMARY KEY,
            RESERVATION_ID      INT4 NOT NULL,
            ITEM_ID             INT4 NOT NULL,
            QUANTITY            NUMERIC(2,0));

COMMENT ON TABLE RESERVATION_ITEM IS 'Ordered item with quantity';
COMMENT ON COLUMN RESERVATION_ITEM.RES_ITEM_ID IS 'Reservation Item Id';
COMMENT ON COLUMN RESERVATION_ITEM.RESERVATION_ID IS 'Reservation id';
COMMENT ON COLUMN RESERVATION_ITEM.ITEM_ID IS 'Item Id';
COMMENT ON COLUMN RESERVATION_ITEM.QUANTITY IS 'Quantity of item';

ALTER TABLE RESERVATION_ITEM ADD CONSTRAINT FK_RES_ITEM_RESERVATION FOREIGN KEY (RESERVATION_ID) REFERENCES RESERVATION (RESERVATION_ID);
ALTER TABLE RESERVATION_ITEM ADD CONSTRAINT FK_RES_ITEM_MENU_ITEM FOREIGN KEY (ITEM_ID) REFERENCES MENU_ITEM (ITEM_ID);
